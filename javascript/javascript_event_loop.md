# 자바스크립트 이벤트 루프
자바스크립트는 `Single thread` 기반의 언어로, 동시에 하나의 작업만을 수행할 수 있다. 자바스크립트에서 비동기로 실행되는 작업들은 자바스크립트 엔진의  `이벤트 루프`를 통해서 실행한다.

![](https://image.toast.com/aaaadh/real/2018/techblog/b1493856379d11e69c16a9a4cf841567.png)

```javascript
function foo() {
    console.log('foo!');
}
function baz() {
    console.log('baz!');
}

setTimeout(baz, 10); // (1)
foo();
```

1. 코드를 실행하면 코드 자체를 말하는 `main()`이 스택에 쌓인다.
2. 함수를 정의한다. 
3. 함수 정의가 끝난 후 함수 호출문을 만나게 되고,  `setTimeout`이 스택에 추가되자마자 실행되어 WebAPI 영역으로 이동한다. 브라우저는 `setTimeout`을 실행시켜 카운트다운을 시작한다.
4. `foo`를 스택에 추가되어 함수가 실행된다. 실행후 스택에서 지워진다.
5. WebAPI의 작업이 완료되면, 콜백 인 `baz`를 테스크 큐에 추가한다.
6. 이벤트 루프는 콜 스택과 테스크 큐를 주시하고 있다가, 스택이 비어있으면 큐의 첫번째 작업인 `baz`를 스택에 추가한다.
7. `baz`가 실행된다.


## Call Stack
자바스크립트 엔진은 하나의 호출 스택(하나의 스레드만 사용하므로)을 사용하며, 현재 스택에 쌓여있는 모든 함수들이 실행을 마치고 스택에서 제거되기 전까지는 다른 어떠한 함수도 실행될 수 없다. 

> **Stack**
> 후입선출의 자료구조. 새로 들어오는 데이터의 위치가 저장소의 끝부분에 추가되고, 내보내는 데이터 역시 저장소의 끝부분에서 나간다. 책을 쌓는 것과 같은 원리로 동작한다.

## Task Queue
WepAPI를 통해 넘겨받은 비동기 작업들의 콜백 함수가 대기하는 영역이다. 

> **Queue**
> 선입선출의 자료구조. 새로 들어오는 데이터는 저장소의 끝부분에 추가되고, 내보내는 데이터는 먼저 들어온 데이터의 순서데로 나간다. 매표소와 같은 원리로 동작한다.

## Event Loop
호출 스택이 비워질 때마다 큐에서 콜백함수를 꺼내 스택에 추가하여 실행하는 역할을 한다.
 
